<!DOCTYPE html>
<html>
<body>
<button id="connect">連接序列埠</button>
<pre id="output"></pre>

<script>
const output = document.querySelector('#output');
document.querySelector('#connect').addEventListener('click', async () => {
  if ('serial' in navigator) {
    try {
      const port = await navigator.serial.requestPort();
      await port.open({ baudRate: 9600 });
      const reader = port.readable.getReader();

      while (true) {
        const { value, done } = await reader.read();
        if (done) {
          reader.releaseLock();
          break;
        }
        output.textContent = new TextDecoder().decode(value);
      }
    } catch (err) {
      console.error('There was an error opening the serial port:', err);
    }
  } else {
    console.error('Web serial doesn\'t seem to be enabled in your browser. Try enabling it by visiting:');
    console.error('chrome://flags/#enable-experimental-web-platform-features');
    console.error('opera://flags/#enable-experimental-web-platform-features');
    console.error('edge://flags/#enable-experimental-web-platform-features');
  }
});
</script>

</body>
</html>
